{"filter":false,"title":"hitcounter.js","tooltip":"/main-workshop/lib/lambda/hitcounter.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":27,"column":2},"action":"insert","lines":["const { DynamoDB, Lambda } = require('aws-sdk');","","exports.handler = async function(event) {","  console.log(\"request:\", JSON.stringify(event, undefined, 2));","","  // create AWS SDK clients","  const dynamo = new DynamoDB();","  const lambda = new Lambda();","","  // update dynamo entry for \"path\" with hits++","  await dynamo.updateItem({","    TableName: process.env.HITS_TABLE_NAME,","    Key: { path: { S: event.path } },","    UpdateExpression: 'ADD hits :incr',","    ExpressionAttributeValues: { ':incr': { N: '1' } }","  }).promise();","","  // call downstream function and capture response","  const resp = await lambda.invoke({","    FunctionName: process.env.DOWNSTREAM_FUNCTION_NAME,","    Payload: JSON.stringify(event)","  }).promise();","","  console.log('downstream response:', JSON.stringify(resp, undefined, 2));","","  // return response back to upstream caller","  return JSON.parse(resp.Payload);","};"],"id":1}]]},"ace":{"folds":[],"scrolltop":125,"scrollleft":0,"selection":{"start":{"row":27,"column":2},"end":{"row":27,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":10,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1708692807347,"hash":"fcce8aaef4761d8424e8fc46e2408c727cca1c7b"}